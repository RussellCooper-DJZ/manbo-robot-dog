# 4舵机配置说明

## 📋 硬件配置

本机器狗采用**4舵机简化设计**,每条腿使用1个舵机控制,相比8舵机版本更加经济实惠且易于制作。

### 舵机布局

```
        前方
    ┌─────────┐
    │ 1     3 │  1: 左前腿舵机
    │         │  2: 左后腿舵机
    │ 2     4 │  3: 右前腿舵机
    └─────────┘  4: 右后腿舵机
```

### 引脚连接

| 舵机编号 | 位置 | STM32引脚 | 定时器通道 | PWM输出 |
|---------|------|-----------|-----------|---------|
| 舵机1 | 左前腿 | PA0 | TIM3_CH1 | PWM1 |
| 舵机2 | 左后腿 | PA1 | TIM3_CH2 | PWM2 |
| 舵机3 | 右前腿 | PA2 | TIM3_CH3 | PWM3 |
| 舵机4 | 右后腿 | PA3 | TIM3_CH4 | PWM4 |

## 🎮 运动原理

### 基本姿态

**站立姿态** (所有舵机90°):
```
舵机1: 90°  舵机3: 90°
舵机2: 90°  舵机4: 90°
```

### 运动步态

#### 1. 前进

采用对角步态:

**步骤1**: 左前右后抬起
```
舵机1: 135°  舵机3: 90°
舵机2: 90°   舵机4: 45°
```

**步骤2**: 右前左后抬起
```
舵机1: 90°   舵机3: 45°
舵机2: 135°  舵机4: 90°
```

**步骤3**: 回到中位
```
舵机1: 90°   舵机3: 90°
舵机2: 90°   舵机4: 90°
```

#### 2. 后退

与前进相反的步态序列。

#### 3. 左转

```
舵机1: 135°  舵机3: 135°
舵机2: 45°   舵机4: 45°
```

#### 4. 右转

```
舵机1: 45°   舵机3: 45°
舵机2: 135°  舵机4: 135°
```

## 🔧 角度说明

### 舵机角度范围
- **最小角度**: 0° (完全向一侧摆动)
- **中位角度**: 90° (垂直站立)
- **最大角度**: 180° (完全向另一侧摆动)

### 常用角度
- **45°**: 向外摆动45°
- **90°**: 中位,垂直站立
- **135°**: 向内摆动45°

## ⚙️ PWM配置

### 定时器配置
```c
TIM_Period = 20000 - 1;      // 20ms周期 (50Hz)
TIM_Prescaler = 72 - 1;      // 72MHz / 72 = 1MHz
```

### 角度到PWM的转换公式
```c
PWM_Value = (Angle / 180) * 2000 + 500;
```

**示例**:
- 0° → PWM = 500 (0.5ms)
- 90° → PWM = 1500 (1.5ms)
- 180° → PWM = 2500 (2.5ms)

## 🎯 优势与限制

### 优势
1. **成本低**: 只需4个舵机,成本降低50%
2. **结构简单**: 机械结构更简单,易于组装
3. **功耗低**: 舵机数量减半,续航时间更长
4. **控制简单**: 编程逻辑更清晰

### 限制
1. **灵活性**: 无法实现复杂的腿部弯曲动作
2. **越障能力**: 无法抬高腿部跨越障碍物
3. **速度**: 运动速度相对较慢
4. **稳定性**: 在不平坦地面上稳定性稍差

## 📊 性能对比

| 特性 | 4舵机版本 | 8舵机版本 |
|------|----------|----------|
| 舵机数量 | 4个 | 8个 |
| 成本 | ~¥20 | ~¥40 |
| 功耗 | 低 | 中 |
| 运动灵活性 | 基础 | 高级 |
| 编程难度 | 简单 | 中等 |
| 适用场景 | 学习、展示 | 竞赛、研究 |

## 🛠️ 调试建议

### 1. 舵机校准
```c
// 所有舵机设置为90°中位
Servo_SetAngle1(90);
Servo_SetAngle2(90);
Servo_SetAngle3(90);
Servo_SetAngle4(90);
```

### 2. 角度微调

如果机器狗站立不稳,可以微调中位角度:
```c
// 示例:左前腿稍微向外调整
Servo_SetAngle1(85);  // 原来是90°
```

### 3. 速度调整

通过修改延时时间调整运动速度:
```c
int movedelay = 150;  // 默认150ms
// 增大延时 → 运动变慢但更稳定
// 减小延时 → 运动变快但可能不稳
```

## 🔄 升级到8舵机

如果未来需要升级到8舵机版本:

1. **硬件准备**:
   - 增加4个舵机
   - 增加PWM输出引脚
   - 增强电源供电能力

2. **软件修改**:
   - 修改PWM初始化,增加4路输出
   - 增加舵机控制函数
   - 重新设计运动步态

3. **机械结构**:
   - 修改3D打印件,增加膝关节
   - 调整腿部连杆长度

## 📖 相关代码文件

- `Hardware/Servo.c/h`: 舵机控制函数
- `Hardware/PWM.c/h`: PWM信号生成
- `Hardware/Movement.c/h`: 运动步态定义
- `User/main.c`: 主程序逻辑

## 💡 使用建议

1. **初学者**: 建议从4舵机版本开始,掌握基本原理
2. **进阶用户**: 可以尝试优化步态算法,提升运动性能
3. **竞赛项目**: 建议升级到8舵机版本,获得更好的性能

---

**文档版本**: v1.0  
**更新日期**: 2025-10-24  
**适用硬件**: 4舵机版本曼波机器狗

